<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>(MSc) Data Mining</title>

    <!-- Bootstrap core CSS -->
    <link href="../../../style/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../../../style/codehilite/css/default.css" rel="stylesheet">
    <link href="../../../style/misc/css/module.css" rel="stylesheet">
    <link href="../../../style/misc/css/practical.css" rel="stylesheet">

	<script type="text/javascript"
	  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
	</script>

  </head>

<body>

	<!-- Fixed navbar -->
	<div class="navbar navbar-default navbar-fixed-top" role="navigation">
		<div class="container">
			
			
	    	<div class="collapse navbar-collapse">

				<ul class="nav navbar-nav navbar-left">
					<!-- Moodle -->
					<li>
						<div class="navbar-header">
							<a class="navbar-brand" href="https://moodle.wit.ie/course/view.php?id=209190" target="_blank"><img height="18pt" src="../../../style/misc/img/moodle_logo_on_blue.gif" /></a>
						</div>						
					</li>
					<li>
						<div class="navbar-header">
							<a class="navbar-brand" href="https://datamining202425.slack.com" target="_blank"><img height="15pt" src="../../../style/misc/img/slack_logo.png" /></a>
						</div>						
					</li>
				</ul>

	      		<ul class="nav navbar-nav navbar-right">

					<!-- module home -->
					<li>
						<div class="navbar-header">
							<a class="navbar-brand" href="../../../index.html"><span class="glyphicon glyphicon-home"></span></a>
						</div>						
					</li>
					
					<!-- topics -->
	        		<li>
						<div class="navbar-collapse collapse" id="b">
							<ul class="nav navbar-nav">
								<li class="dropdown">
									<a href="#" class="dropdown-toggle" data-toggle="dropdown">
										<span class="glyphicon glyphicon-list-alt"></span>
									</a>
									<ul class="dropdown-menu" role="menu">
										<li class="dropdown-header">Topics</li>
										
									</ul>
								</li>
							</ul>
						</div>			
					</li>

					<!-- resources -->
	        		<li>
						<div class="navbar-collapse collapse" id="b">
							<ul class="nav navbar-nav">
								<li class="dropdown">
									<a href="#" class="dropdown-toggle" data-toggle="dropdown">
										<span class="glyphicon glyphicon-th-list"></span>
									</a>
									<ul class="dropdown-menu" role="menu">
										<li class="dropdown-header">Resources</li>
										
										<li >
											<a href="../../../topics/04-Regression/index.html#01-Overview">Overview</a>
										</li>
										
										<li class="active">
											<a href="../../../topics/04-Regression/index.html#02-Practical">Practical</a>
										</li>
										
										<li >
											<a href="../../../topics/04-Regression/index.html#03-Resources">Resources</a>
										</li>
										
									</ul>
								</li>
							</ul>
						</div>			
					</li>
								
					<!-- pages-->
	        		<li>
						<div class="navbar-collapse collapse" id="c">
							<ul class="nav navbar-nav">
								<li class="dropdown">
									<a href="#" class="dropdown-toggle" data-toggle="dropdown">
										<span>Advertising</span
									</a>
									<ul class="dropdown-menu" role="menu">
										
										<li >
											<a href="00-Outline.html">Outline</a>
										</li>
										
										<li >
											<a href="01-Diamonds.html">Diamonds</a>
										</li>
										
										<li >
											<a href="02-CreditBalance.html">CreditBalance</a>
										</li>
										
										<li class="active">
											<a href="03-Advertising.html">Advertising</a>
										</li>
										
										<li >
											<a href="04-ConfidenceLimits.html">ConfidenceLimits</a>
										</li>
										
									</ul>
								</li>
							</ul>
						</div>			
					</li> 
					
	        	</ul>
			</div>
		</div>
	</div>

	<!-- contents -->
	<div class="container">
		
		<ul class="pager">
			
			<li class="previous"><a href="02-CreditBalance.html">&larr; Previous (CreditBalance)</a></li>
			
			
			
			<li class="next"><a href="04-ConfidenceLimits.html">Next (ConfidenceLimits) &rarr;</a></li>
			
		</ul>
		
		<h1>The Advertising Data Example</h1>
<p>We recommend that you create an <code>Advertising</code> folder and save the notebook you are working on to that folder.</p>
<h2>Read the data from a CSV file.</h2>
<p>This is where the <a href="https://pandas.pydata.org/">pandas</a> is very useful, as it provides much of the basic data handling required for python machine learning.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="n">dataFile</span> <span class="o">=</span> <span class="s2">&quot;data/Advertising.csv&quot;</span>
<span class="n">ad</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">dataFile</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

<h2>Review the data</h2>
<p>This is an opportunity to use the exploratory data analysis (EDA) techniques that were covered by Kieran in Week 3.</p>
<p>Use scatter plots, overlaid on the same plot, to get a sense of how Sales varies with Newspaper, Radio and TV.</p>
<h2>Fit the training data using <em>all</em> the natural features</h2>
<p>As we did in class, we are going to compare different linear models, beginning with the full set of natural features. You might find the following helpful:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.formula.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="n">modelAll</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;Sales ~ TV + Radio + Newspaper&#39;</span><span class="p">,</span> <span class="n">ad</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>

<p>As with the diamond data, you will also need the $R^2$ and root-mean-square residual error (RMSRE) of each fit as metrics for this and other OLS fits to the Advertising data.</p>
<p>You should review the model summary, residuals, etc, to look for evidence that the fit satisfies the assumptions of linear regression. You should make a note of your findings in nearby markdown cells.</p>
<h2>Use forward selection techniques to find the "best" model</h2>
<p>The slides presented in class describe how to proceed. This is a "greedy" search technique (in the sense that you choose the best available option at each stage, without trying to decide what would be the best option over all stages). You should find that the best model with the existing features has the formula <code>Sales ~ TV + Radio</code> but that it can be improved if the TV-radio interaction term <code>TV:Radio</code> is added.</p>
<h2>Plotting the multivariate residuals</h2>
<p>With the Diamond data, there was only one prediction variable so it was easy to visualise the residuals, since they were functions of one feature (<code>weight</code>). For the advertising data, with more than one feature (such as the best model above), plotting residuals is more difficult. It is possible to suppress a variable (i.e., either TV <em>or</em> Radio ) one at a time and this provides some indication of their distribution, but interpreting the the resulting pair of plots requires care.</p>
<p>Plotting multivariate residuals directly requires advanced visualisation techniques. </p>
<h2>Resources</h2>
<p>The <a href="files/data/Advertising.csv">data file</a> (right-click and download as `Advertising/data/Advertising.csv) is available for your use.</p>
		
		<ul class="pager">
			
			<li class="previous"><a href="02-CreditBalance.html">&larr; Previous (CreditBalance)</a></li>
			
			
			
			<li class="next"><a href="04-ConfidenceLimits.html">Next (ConfidenceLimits) &rarr;</a></li>
			
		</ul>

	</div>
	
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="../../../style/bootstrap/js/bootstrap.min.js"></script>
	
  </body>
</html>